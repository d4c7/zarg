<!--
SPDX-FileCopyrightText: 2023 David CastaÃ±on Belloso <d4c7@proton.me>
SPDX-License-Identifier: EUPL-1.2
This file is part of zig-argueando project (https://github.com/d4c7/zig-argueando)
-->
# Zig-Argueando

Zig-Argueando is a minimalist and efficient command-line parsing library written in Zig. It is designed to offer a convenient way of parsing command-line arguments in a simple yet powerful manner. With Zig-Argueando, you can easily set options, flags, and positional arguments for your command-line applications.

## Origin

Zig-Argueando was originally conceived as part of a [blog post](https://d4c7.github.io/zig-zagueando/posts/un-analizador-de-linea-de-comandos-en-zig-1/) at [Zig-Zagueando](https://d4c7.github.io/zig-zagueando/) intended to demonstrate the capabilities of Zig as a language for building command-line tools but, who knowns, it could resonate with some developers, leading to further enhancement and formalization of the original idea into a full standalone library. 

The simplicity and expressiveness of Zig-Argueando exemplify the main principles of the Zig language. Our mission with this library is to provide a tool that is both easy to use and efficient, promoting best practices for command-line interface development in Zig.

## Features

- Parses command-line arguments into an autogenerated struct
- Automatic generation of usage and help text including headers, footers, types...
- Support for flags, options, and positional arguments
- Support for multi-option arguments
- You can define the separator between options and arguments
- Provides built-in support for basic and complex argument types, including enums and JSON
- Offers the ability to define and use custom argument types
- Includes default validators for arguments, reducing the boilerplate code
- Enables users to define and use custom validation rules for arguments
- Choose between halting at the first encountered problem or collecting all problems
- Highly customizable and easy to use
- Lightweight with no dependencies
- Leverages Zig's powerful compile-time feature as much as possible

TODO: Documentation

## Install

### Manually
To use Zig-Argueando in your project, you need to add it to your `build.zig` file:

```zig
const Build = @import("std").build;

pub fn build(b: *Build.Builder) void {
    const target = b.standardTargetOptions(.{});
    const optimize = b.standardOptimizeOption(.{});
    
    const exe = b.addExecutable(.{
        .name = "my-app",
        .root_source_file = .{ .path = "main.zig" },
        .target = target,
        .optimize = optimize,
    });

    var argueandoModule = b.addModule("argueando", .{ .source_file = FileSource{ .path = "lib/zig-argueando/argueando.zig" } });
    exe.addModule("argueando", argueandoModule);
}
```
Replace `"path/to/zig-argueando/argueando.zig"` with the path to this library's source code on your system.

### Using gyro

TO DO

## Usage

Define a struct that defines the command-line arguments, help texts, headers and types you want to parse:

```zig
    const clp = comptime Argueando.CommandLineParser.init(.{
        .header=
        \\    \                                                |        
        \\   _ \     __|  _` |  |   |   _ \   _` |  __ \    _` |   _ \  
        \\  ___ \   |    (   |  |   |   __/  (   |  |   |  (   |  (   | 
        \\_/    _\ _|   \__, | \__,_| \___| \__,_| _|  _| \__,_| \___/  
        \\              |___/  
        ,.params = &[_]Argueando.Param{
            flagHelp(.{ .long = "help", .short = "h", .help = "Shows this help." }),
            flag(.{ .long = "version", .help = "Output version information and exit." }),
            flag(.{ .long = "verbose", .short = "v", .help = "Enable verbose output." }),
            option(.{ .long = "port", .short = "p", .parser = "TCP_PORT", .default = "1234", .help = "Listening Port." }),
            option(.{ .long = "host", .short = "H", .parser = "TCP_HOST", .default = "localhost", .help = "Host name" }),
            singlePositional(.{ .parser = "DIR", .default = ".", .check = &Check.Dir(.{ .mode = .read_only }).f }),
        }, 
        .desc = "This command starts an HTTP Server and serves static content from directory DIR.", 
        .footer = "More info: <https://d4c7.github.io/zig-zagueando/>.",
    });
```

The field `params` in the struct defines the option and positional arguments.

Then, in your `main` function, use the `parse` function to parse the command-line arguments:

```zig
var s = clp.parseArgs(allocator);
defer s.deinit();

if (s.helpRequested()) {
    try s.printHelp(std.io.getStdErr().writer());
    return;
}

if (s.hasProblems()) {
    try s.printProblems(std.io.getStdErr().writer(), .AllProblems);
    return;
}

std.debug.print("dir: {s}\n", .{s.arg.positional});
std.debug.print("port: {d}\n", .{s.arg.port});
std.debug.print("host: {s}\n", .{s.arg.host});

```

TODO: View more examples in the `examples` folder.

## Caution

Please note that Zig-Argueando is a work in progress being developed and tested using Zig compiler version `0.11.0-dev.3971`, for more instability. If you are using a different Zig compiler version, we cannot guarantee that the library will work as expected. Before reporting any issues, please make sure you are using the recommended Zig compiler version. It is always a good practice to use the same compiler version that a library or application was developed with to avoid any compatibility issues. We are continuously working on providing support for newer versions of the Zig compiler. Please stay tuned for updates.

IT IS NOT READY FOR PRODUCTION USE, the first stable version is targeted at the next stable version of Zig (i.e. version 0.11.0). 

## Contribution

We welcome all contributions! Please feel free to submit a PR or create an issue if you encounter any problem or have a feature request.

## License

Zig-Argueando is licensed under the EUPL-1.2 license. Please check the `LICENSES` folder for more details.